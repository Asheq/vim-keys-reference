<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../bower_components/paper-tooltip/paper-tooltip.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../shared-styles.html">
<link rel="import" href="normal-mode-keys-styles.html">

<dom-module id="normal-mode-keys">
  <template>
    <style include="shared-styles"></style>
    <style include="normal-mode-keys-styles"></style>
    <div class="card">
      <iron-ajax
        auto
        url="data/default-normal-mode-keys.json"
        handle-as="json"
        loading="{{dataLoading}}"
        last-response="{{keysJson}}">
      </iron-ajax>
      <paper-checkbox label="Show Descriptions" checked="{{showDescriptions}}"></paper-checkbox> Show Descriptions
      <div class="legend">
        <h3 class="legend__label">Legend</h3>
        <table class="legend__table">
          <tr>
            <td class="legend__td--operator">Operator</td>
            <td class="legend__td--motion">Motion</td>
            <td class="legend__td--command">Command</td>
            <td class="legend__td--extended">Extended</td>
            <td class="legend__td--unused">Unused</td>
          </tr>
        </table>
        <template is="dom-if" if="[[showDescriptions]]">
          <p>
          <i>N</i> - a number entered before the key<br>
          <i>{motion}</i> - a cursor movement command following an operator<br>
          <i>{char}</i> - a character used with some motions (like f)<br>
          <i>{filter}</i> - a command-line program following the ! operator<br>
          <i>{pattern}</i> - a pattern following the / search command<br>
          <i>Nmove</i> - the text that is moved over with a {motion}<br>
          <i>SECTION</i> - a section that possibly starts with '}' instead of '{'<br>
          <i>CHAR</i> - any non-blank character<br>
          <i>WORD</i> - a sequence of non-blank characters<br>
          </p>
          <!-- TODO: Single letter operators: c, y, d, = -->
        </template>
      </div>
      <div class="keys">
        <table class="keys__table">
          <thead class="keys__table-header">
            <tr>
              <th>
                key
              </th>
              <th>
                Shift+key
              </th>
              <th>
                g key
              </th>
              <th>
                g Shift+key
              </th>
              <th>
                z key
              </th>
              <th>
                z Shift+key
              </th>
              <th>
                [ key
              </th>
              <th>
                [ Shift+key
              </th>
              <th>
                Ctrl+key
              </th>
            </tr>
          </thead>
          <tbody>
            <template is="dom-repeat" items="[[keys]]" as="keyObj">
              <tr>
                <template is="dom-repeat" items="[[_toArray(keyObj.variations)]]" as="variation">
                  <td class$="keys__td--[[variation.value.type]]">

                    <!-- Pretty display -->
                    <div class=keys__td-pretty-display>
                      [[variation.value.prettyDisplay]]
                    </div>

                    <!-- Description -->
                    <template is="dom-if" if="[[showDescriptions]]">
                      <div>
                        <span>[[variation.value.description]]</span>
                        <!-- <template is="dom-if" if="[[isEqual(variation.value.type,'unused')]]"> -->
                        <!--   <div class="free-div"> -->
                        <!--     <i>Free!</i> -->
                        <!--   </div> -->
                        <!-- </template> -->
                      </div>
                    </template>

                    <!-- Special icons -->
                    <template is="dom-if" if=[[variation.value.duplicates]]>
                      <div style="display:inline-block">
                        <iron-icon icon="content-copy"></iron-icon>
                        <paper-tooltip>Duplicate with [[variation.value.duplicates]]</paper-tooltip>
                      </div>
                    </template>

                  </td>
                </template>
              </tr>
            </template>
          </tbody>
        </table>
      </div>
    </div>
  </template>

  <script src="normal-mode-keys.js"></script>
</dom-module>
